import{c as f}from"./api-BACpyIk9.js";import{_ as p,c as d,a as e,b as m,e as v,t as s,F as b,q as c,p as g,o as n}from"./admin-zkDx62Hg.js";const j={name:"ParserObjectView",data(){return{loading:!1,error:null,object:null,objectType:"blocks",objectId:null,selectedImage:null}},async mounted(){this.objectType=this.$route.params.type||"blocks",this.objectId=this.$route.params.id,await this.fetchObject()},methods:{async fetchObject(){this.loading=!0,this.error=null;try{const t={blocks:"/blocks",parkings:"/parkings",villages:"/villages",plots:"/plots","commercial-blocks":"/commercial-blocks","commercial-premises":"/commercial-premises"}[this.objectType]||"/blocks",x=await f(`${t}/${this.objectId}`),a=await x.json();x.ok?this.object=a.data||a:this.error=a.message||"Ошибка при загрузке объекта"}catch(l){console.error("Error fetching object:",l),this.error="Ошибка при загрузке объекта"}finally{this.loading=!1}},goToEdit(){this.$router.push({name:"admin.parser.object.edit",params:{type:this.objectType,id:this.objectId}})},getDataSourceLabel(l){return{parser:"Парсер",manual:"Вручную",feed:"Feed",import:"Импорт"}[l]||l},openImageModal(l){this.selectedImage=l},closeImageModal(){this.selectedImage=null},getImageUrl(l,t=!1){return l?t?l.url_thumbnail||l.thumbnail_url||l.url_full||l.full_url||l.path||null:l.url_full||l.full_url||l.url_thumbnail||l.thumbnail_url||l.path||null:null},hasValidImages(l){return!l||!Array.isArray(l)?!1:l.some(t=>this.getImageUrl(t))},get validImagesCount(){return!this.object?.images||!Array.isArray(this.object.images)?0:this.object.images.filter(l=>this.getImageUrl(l)).length},handleImageError(l){l.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="400" height="300"%3E%3Crect width="400" height="300" fill="%23e5e7eb"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="%239ca3af" font-family="sans-serif" font-size="16"%3EИзображение не найдено%3C/text%3E%3C/svg%3E'}}},_={class:"parser-object-view space-y-6"},k={class:"flex items-center justify-between mb-6"},y={class:"text-3xl font-semibold text-foreground"},h={class:"flex gap-2"},w={key:0,class:"flex items-center justify-center py-12"},I={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},E={class:"text-destructive"},C={key:2,class:"space-y-6"},U={key:0,class:"bg-card rounded-lg border border-border p-6"},M={key:0,class:"mb-6"},D={class:"relative w-full max-w-2xl rounded-lg overflow-hidden border border-border"},L=["src","alt"],S={key:1},T={class:"block text-sm font-medium text-muted-foreground mb-2"},V={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},R=["onClick"],B=["src","alt"],z={key:0,class:"absolute top-2 right-2 bg-accent text-white text-xs px-2 py-1 rounded"},O={class:"bg-card rounded-lg border border-border p-6"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},N={class:"text-foreground"},F={class:"text-foreground"},G={class:"text-foreground font-medium"},P={class:"text-foreground"},q={class:"text-foreground"},H={class:"text-foreground"},J={class:"text-foreground"},K={class:"text-foreground"},Q={class:"bg-card rounded-lg border border-border p-6"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"text-foreground"},Y={class:"text-foreground"},Z={key:0,class:"md:col-span-2"},$={class:"flex flex-wrap gap-2"},ee={class:"bg-card rounded-lg border border-border p-6"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"text-foreground"},se={class:"text-xs text-muted-foreground mt-1"},le={class:"text-foreground"},re={class:"text-xs text-muted-foreground mt-1"},de={class:"bg-card rounded-lg border border-border p-6"},ne={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ie={class:"text-foreground text-2xl font-semibold"},me={class:"text-foreground text-2xl font-semibold"},ue={class:"text-foreground text-2xl font-semibold"},be={class:"bg-card rounded-lg border border-border p-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"text-foreground"},ae={class:"bg-card rounded-lg border border-border p-6"},xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},fe={class:"text-foreground"},pe={class:"text-foreground"},ve={class:"text-foreground"},je={key:1,class:"bg-card rounded-lg border border-border p-6"},_e={class:"space-y-4"},ke={key:0},ye={class:"flex flex-wrap gap-2"},he={key:1},we={class:"flex flex-wrap gap-2"},Ie={key:2},Ee={class:"flex flex-wrap gap-2"},Ce={key:3},Ue={class:"p-4 bg-muted rounded-lg text-xs overflow-auto"},Me={class:"bg-card rounded-lg border border-border p-6"},De={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Le={class:"text-foreground"},Se={class:"text-foreground"},Te={class:"text-foreground"},Ve={class:"text-foreground"},Re={class:"relative max-w-7xl max-h-full"},Be=["src","alt"],ze={key:0,class:"mt-4 text-center text-white"},Oe={key:0,class:"font-semibold"},Ae={key:1,class:"text-sm text-white/80"};function Ne(l,t,x,a,o,i){return n(),d("div",_,[e("div",k,[e("div",null,[e("button",{onClick:t[0]||(t[0]=r=>l.$router.go(-1)),class:"mb-2 text-sm text-muted-foreground hover:text-foreground flex items-center gap-2"},[...t[7]||(t[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),v(" Назад к списку ",-1)])]),e("h1",y,s(o.object?.name||"Загрузка..."),1),t[8]||(t[8]=e("p",{class:"text-muted-foreground mt-1"},"Просмотр объекта парсера",-1))]),e("div",h,[e("button",{onClick:t[1]||(t[1]=(...r)=>i.goToEdit&&i.goToEdit(...r)),class:"h-11 px-6 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors"}," Редактировать ")])]),o.loading?(n(),d("div",w,[...t[9]||(t[9]=[e("p",{class:"text-muted-foreground"},"Загрузка объекта...",-1)])])):m("",!0),o.error?(n(),d("div",I,[e("p",E,s(o.error),1)])):m("",!0),!o.loading&&o.object?(n(),d("div",C,[o.object.main_image&&i.getImageUrl(o.object.main_image)||o.object.images&&o.object.images.length>0&&i.hasValidImages(o.object.images)?(n(),d("div",U,[t[12]||(t[12]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Изображения",-1)),o.object.main_image&&i.getImageUrl(o.object.main_image)?(n(),d("div",M,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Главное изображение",-1)),e("div",D,[e("img",{src:i.getImageUrl(o.object.main_image),alt:o.object.main_image.alt||o.object.name,class:"w-full h-auto object-cover",onError:t[2]||(t[2]=(...r)=>i.handleImageError&&i.handleImageError(...r))},null,40,L)])])):m("",!0),o.object.images&&o.object.images.length>0&&i.hasValidImages(o.object.images)?(n(),d("div",S,[e("label",T," Галерея ("+s(i.validImagesCount)+") ",1),e("div",V,[(n(!0),d(b,null,c(o.object.images.filter(r=>i.getImageUrl(r)),r=>(n(),d("div",{key:r.id,class:"relative aspect-video rounded-lg overflow-hidden border border-border cursor-pointer hover:border-accent transition-colors group",onClick:u=>i.openImageModal(r)},[e("img",{src:i.getImageUrl(r,!0),alt:r.alt||o.object.name,class:"w-full h-full object-cover",onError:t[3]||(t[3]=(...u)=>i.handleImageError&&i.handleImageError(...u))},null,40,B),t[11]||(t[11]=e("div",{class:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center"},[e("svg",{class:"w-8 h-8 text-white opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"})])],-1)),r.is_main?(n(),d("div",z," Главное ")):m("",!0)],8,R))),128))])])):m("",!0)])):m("",!0),e("div",O,[t[21]||(t[21]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Основная информация",-1)),e("div",A,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"ID",-1)),e("p",N,s(o.object.id),1)]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"GUID",-1)),e("p",F,s(o.object.guid||"-"),1)]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Название",-1)),e("p",G,s(o.object.name),1)]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Адрес",-1)),e("p",P,s(o.object.address||"-"),1)]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Город",-1)),e("p",q,s(o.object.city?.name||"-"),1)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Регион",-1)),e("p",H,s(o.object.region?.name||"-"),1)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Локация",-1)),e("p",J,s(o.object.location?.name||"-"),1)]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Застройщик",-1)),e("p",K,s(o.object.builder?.name||"-"),1)])])]),e("div",Q,[t[25]||(t[25]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Местоположение",-1)),e("div",W,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Широта",-1)),e("p",X,s(o.object.coordinates?.latitude||"-"),1)]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Долгота",-1)),e("p",Y,s(o.object.coordinates?.longitude||"-"),1)]),o.object.subways&&o.object.subways.length>0?(n(),d("div",Z,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Метро",-1)),e("div",$,[(n(!0),d(b,null,c(o.object.subways,r=>(n(),d("span",{key:r.id,class:"px-3 py-1 bg-muted rounded-md text-sm"},s(r.name||r.subway_line?.name||"-"),1))),128))])])):m("",!0)])]),e("div",ee,[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Цены",-1)),e("div",te,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Минимальная цена",-1)),e("p",oe,s(o.object.prices?.min_formatted||"-"),1),e("p",se,s(o.object.prices?.min?(o.object.prices.min/100).toLocaleString("ru-RU")+" ₽":""),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Максимальная цена",-1)),e("p",le,s(o.object.prices?.max_formatted||"-"),1),e("p",re,s(o.object.prices?.max?(o.object.prices.max/100).toLocaleString("ru-RU")+" ₽":""),1)])])]),e("div",de,[t[32]||(t[32]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Статистика",-1)),e("div",ne,[e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Всего квартир",-1)),e("p",ie,s(o.object.stats?.apartments_count||0),1)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"На просмотр",-1)),e("p",me,s(o.object.stats?.view_apartments_count||0),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Эксклюзивных",-1)),e("p",ue,s(o.object.stats?.exclusive_apartments_count||0),1)])])]),e("div",be,[t[39]||(t[39]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Статусы",-1)),e("div",ce,[e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Статус",-1)),e("p",ge,s(o.object.status||"-"),1)]),e("div",null,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Активен",-1)),e("span",{class:g(["px-2 py-1 text-xs rounded-md",o.object.is_active?"bg-green-500/10 text-green-500":"bg-red-500/10 text-red-500"])},s(o.object.is_active?"Активен":"Неактивен"),3)]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Сьют",-1)),e("span",{class:g(["px-2 py-1 text-xs rounded-md",o.object.is_suite?"bg-blue-500/10 text-blue-500":"bg-gray-500/10 text-gray-500"])},s(o.object.is_suite?"Да":"Нет"),3)]),e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Эксклюзив",-1)),e("span",{class:g(["px-2 py-1 text-xs rounded-md",o.object.is_exclusive?"bg-purple-500/10 text-purple-500":"bg-gray-500/10 text-gray-500"])},s(o.object.is_exclusive?"Да":"Нет"),3)]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Помечен",-1)),e("span",{class:g(["px-2 py-1 text-xs rounded-md",o.object.is_marked?"bg-yellow-500/10 text-yellow-500":"bg-gray-500/10 text-gray-500"])},s(o.object.is_marked?"Да":"Нет"),3)]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Источник данных",-1)),e("span",{class:g(["px-2 py-1 text-xs rounded-md",o.object.data_source==="parser"?"bg-blue-500/10 text-blue-500":"bg-gray-500/10 text-gray-500"])},s(i.getDataSourceLabel(o.object.data_source)),3)])])]),e("div",ae,[t[43]||(t[43]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Сроки",-1)),e("div",xe,[e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Срок сдачи",-1)),e("p",fe,s(o.object.deadline||"-"),1)]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Дата сдачи",-1)),e("p",pe,s(o.object.deadline_date?new Date(o.object.deadline_date).toLocaleDateString("ru-RU"):"-"),1)]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Отделка",-1)),e("p",ve,s(o.object.finishing||"-"),1)])])]),o.object.metadata||o.object.advantages||o.object.payment_types||o.object.contract_types?(n(),d("div",je,[t[48]||(t[48]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Дополнительная информация",-1)),e("div",_e,[o.object.advantages&&o.object.advantages.length>0?(n(),d("div",ke,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Преимущества",-1)),e("div",ye,[(n(!0),d(b,null,c(o.object.advantages,(r,u)=>(n(),d("span",{key:u,class:"px-3 py-1 bg-muted rounded-md text-sm"},s(r),1))),128))])])):m("",!0),o.object.payment_types&&o.object.payment_types.length>0?(n(),d("div",he,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Типы оплаты",-1)),e("div",we,[(n(!0),d(b,null,c(o.object.payment_types,(r,u)=>(n(),d("span",{key:u,class:"px-3 py-1 bg-muted rounded-md text-sm"},s(r),1))),128))])])):m("",!0),o.object.contract_types&&o.object.contract_types.length>0?(n(),d("div",Ie,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Типы договоров",-1)),e("div",Ee,[(n(!0),d(b,null,c(o.object.contract_types,(r,u)=>(n(),d("span",{key:u,class:"px-3 py-1 bg-muted rounded-md text-sm"},s(r),1))),128))])])):m("",!0),o.object.metadata?(n(),d("div",Ce,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-2"},"Метаданные",-1)),e("pre",Ue,s(JSON.stringify(o.object.metadata,null,2)),1)])):m("",!0)])])):m("",!0),e("div",Me,[t[53]||(t[53]=e("h2",{class:"text-xl font-semibold text-foreground mb-4"},"Временные метки",-1)),e("div",De,[e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Создано",-1)),e("p",Le,s(o.object.created_at?new Date(o.object.created_at).toLocaleString("ru-RU"):"-"),1)]),e("div",null,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Обновлено",-1)),e("p",Se,s(o.object.updated_at?new Date(o.object.updated_at).toLocaleString("ru-RU"):"-"),1)]),e("div",null,[t[51]||(t[51]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Спарсено",-1)),e("p",Te,s(o.object.parsed_at?new Date(o.object.parsed_at).toLocaleString("ru-RU"):"-"),1)]),e("div",null,[t[52]||(t[52]=e("label",{class:"block text-sm font-medium text-muted-foreground mb-1"},"Последняя синхронизация",-1)),e("p",Ve,s(o.object.last_synced_at?new Date(o.object.last_synced_at).toLocaleString("ru-RU"):"-"),1)])])])])):m("",!0),o.selectedImage?(n(),d("div",{key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",onClick:t[6]||(t[6]=(...r)=>i.closeImageModal&&i.closeImageModal(...r))},[e("div",Re,[e("button",{onClick:t[4]||(t[4]=(...r)=>i.closeImageModal&&i.closeImageModal(...r)),class:"absolute top-4 right-4 z-10 w-10 h-10 bg-black/50 hover:bg-black/70 text-white rounded-full flex items-center justify-center transition-colors"},[...t[54]||(t[54]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),e("img",{src:i.getImageUrl(o.selectedImage),alt:o.selectedImage.alt||o.object?.name,class:"max-w-full max-h-[90vh] object-contain rounded-lg",onError:t[5]||(t[5]=(...r)=>i.handleImageError&&i.handleImageError(...r))},null,40,Be),o.selectedImage.alt||o.selectedImage.title?(n(),d("div",ze,[o.selectedImage.title?(n(),d("p",Oe,s(o.selectedImage.title),1)):m("",!0),o.selectedImage.alt?(n(),d("p",Ae,s(o.selectedImage.alt),1)):m("",!0)])):m("",!0)])])):m("",!0)])}const Pe=p(j,[["render",Ne]]);export{Pe as default};
