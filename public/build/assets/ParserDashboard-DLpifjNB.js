import{b as p}from"./api-BACpyIk9.js";import{S as l}from"./sweetalert2.esm.all-C0u8rGqG.js";import{_ as x,c as r,a as e,t as n,f as u,g as c,F as h,q as _,h as y,o,e as g}from"./admin-zkDx62Hg.js";const v={name:"ParserDashboard",data(){return{loading:!0,running:!1,stats:{total:0,activeSchedules:0,recentErrors:0,lastRun:null},recentActivity:[]}},async mounted(){await this.fetchStats()},methods:{async fetchStats(){this.loading=!0;try{this.stats={total:0,activeSchedules:0,recentErrors:0,lastRun:null}}catch(i){console.error("Error fetching stats:",i)}finally{this.loading=!1}},async runParser(){if(!(this.running||!(await l.fire({title:"Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€?",text:"ÐŸÐ°Ñ€ÑÐµÑ€ Ð±ÑƒÐ´ÐµÑ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð³Ð¾Ñ€Ð¾Ð´Ð¾Ð² Ð¸ Ñ‚Ð¸Ð¿Ð¾Ð² Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²",icon:"question",showCancelButton:!0,confirmButtonText:"Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ",cancelButtonText:"ÐžÑ‚Ð¼ÐµÐ½Ð°",confirmButtonColor:"#9333ea"})).isConfirmed)){this.running=!0;try{const t=await p("/parser/run",{});if(!t.ok){const f=await t.json().catch(()=>({}));throw new Error(f.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ð¿Ð°Ñ€ÑÐµÑ€Ð°")}const m=await t.json();await l.fire({icon:"success",title:"ÐŸÐ°Ñ€ÑÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½",text:m.message||"ÐŸÐ°Ñ€ÑÐµÑ€ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð² Ñ„Ð¾Ð½Ð¾Ð²Ð¾Ð¼ Ñ€ÐµÐ¶Ð¸Ð¼Ðµ",timer:3e3,showConfirmButton:!1}),setTimeout(()=>{this.fetchStats()},5e3)}catch(t){console.error("Error running parser:",t),await l.fire({icon:"error",title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:t.message||"ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€"})}finally{this.running=!1}}}}},w={class:"parser-dashboard-page space-y-6"},k={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},S={class:"bg-card rounded-lg border border-border p-6"},B={class:"text-2xl font-bold text-foreground"},C={class:"bg-card rounded-lg border border-border p-6"},E={class:"text-2xl font-bold text-foreground"},D={class:"bg-card rounded-lg border border-border p-6"},P={class:"text-2xl font-bold text-foreground"},R={class:"bg-card rounded-lg border border-border p-6"},T={class:"text-sm font-medium text-foreground"},j={class:"bg-card rounded-lg border border-border p-6"},A={class:"flex flex-wrap gap-4"},L=["disabled"],N={key:0},V={key:1},q={class:"bg-card rounded-lg border border-border p-6"},F={key:0,class:"text-center py-8 text-muted-foreground"},U={key:1,class:"text-center py-8 text-muted-foreground"},z={key:2,class:"space-y-2"},G={class:"text-sm font-medium text-foreground"},H={class:"text-xs text-muted-foreground"};function I(i,t,m,f,s,b){const a=y("router-link");return o(),r("div",w,[t[10]||(t[10]=e("div",{class:"mb-6"},[e("h1",{class:"text-3xl font-semibold text-foreground"},"ÐŸÐ°Ñ€ÑÐµÑ€ Ð´Ð°Ð½Ð½Ñ‹Ñ…"),e("p",{class:"text-muted-foreground mt-1"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð°Ñ€ÑÐµÑ€Ð¾Ð¼ Ð´Ð°Ð½Ð½Ñ‹Ñ… TrendAgent")],-1)),e("div",k,[e("div",S,[t[1]||(t[1]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"Ð’ÑÐµÐ³Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²",-1)),e("p",B,n(s.stats.total||0),1)]),e("div",C,[t[2]||(t[2]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ð¹",-1)),e("p",E,n(s.stats.activeSchedules||0),1)]),e("div",D,[t[3]||(t[3]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"ÐžÑˆÐ¸Ð±Ð¾Ðº (24Ñ‡)",-1)),e("p",P,n(s.stats.recentErrors||0),1)]),e("div",R,[t[4]||(t[4]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð·Ð°Ð¿ÑƒÑÐº",-1)),e("p",T,n(s.stats.lastRun?new Date(s.stats.lastRun).toLocaleString("ru-RU"):"ÐÐµ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ð»ÑÑ"),1)])]),e("div",j,[t[8]||(t[8]=e("h2",{class:"text-lg font-semibold mb-4"},"Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",-1)),e("div",A,[e("button",{onClick:t[0]||(t[0]=(...d)=>b.runParser&&b.runParser(...d)),disabled:s.running,class:"px-4 py-2 bg-purple-500 hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors font-medium"},[s.running?(o(),r("span",N,"Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ð°Ñ€ÑÐµÑ€Ð°...")):(o(),r("span",V,"ðŸš€ Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€ÑÐµÑ€"))],8,L),u(a,{to:"/parser/objects",class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors"},{default:c(()=>[...t[5]||(t[5]=[g(" ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð² ",-1)])]),_:1}),u(a,{to:"/parser/schedules",class:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors"},{default:c(()=>[...t[6]||(t[6]=[g(" Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸ÑÐ¼Ð¸ ",-1)])]),_:1}),u(a,{to:"/parser/errors",class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors"},{default:c(()=>[...t[7]||(t[7]=[g(" ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€ Ð¾ÑˆÐ¸Ð±Ð¾Ðº ",-1)])]),_:1})])]),e("div",q,[t[9]||(t[9]=e("h2",{class:"text-lg font-semibold mb-4"},"ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÑÑ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ",-1)),s.loading?(o(),r("div",F," Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°... ")):s.recentActivity.length===0?(o(),r("div",U," ÐÐµÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ ")):(o(),r("div",z,[(o(!0),r(h,null,_(s.recentActivity,d=>(o(),r("div",{key:d.id,class:"flex items-center justify-between p-3 bg-muted/30 rounded-lg"},[e("div",null,[e("p",G,n(d.message),1),e("p",H,n(new Date(d.created_at).toLocaleString("ru-RU")),1)])]))),128))]))])])}const O=x(v,[["render",I]]);export{O as default};
