import{_ as S,r as f,c as n,a as t,t as i,b as g,d as m,I as E,v as x,o as l,n as A,k as T,x as J,F as I,q as V,h as D,p as P,w as R,N as G,f as F,m as W,l as X}from"./admin-BdsksX9t.js";import{a as z,c as B,b as Y,d as L}from"./api-BACpyIk9.js";import{S as M}from"./sweetalert2.esm.all-C0u8rGqG.js";const Z={name:"ConsultationDetail",props:{consultation:{type:Object,required:!0},botId:{type:[String,Number],required:!0}},emits:["close","updated"],setup(d,{emit:e}){const a=f(!1),o=f({status:d.consultation.status,admin_notes:d.consultation.admin_notes||""});return{form:o,saving:a,saveConsultation:async()=>{a.value=!0;try{const s=await z(`/bot-management/${d.botId}/consultations/${d.consultation.id}`,o.value);if(!s.ok){const r=await s.json().catch(()=>({}));throw new Error(r.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ")}await M.fire({title:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("updated"),e("close")}catch(s){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:s.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ",icon:"error",confirmButtonText:"ÐžÐš"})}finally{a.value=!1}},formatDate:s=>new Date(s).toLocaleString("ru-RU")}}},$={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},ee={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"},te={class:"sticky top-0 bg-background border-b border-border p-6"},oe={class:"flex items-center justify-between"},se={class:"text-lg font-semibold"},re={class:"p-6 space-y-6"},le={key:0},ne={class:"bg-muted/30 rounded-lg p-4"},de={class:"text-sm"},ae={key:0,class:"text-sm"},ie={key:1,class:"text-sm"},ue={class:"space-y-3"},me={class:"text-sm"},be={class:"text-sm"},ce={key:0},fe={class:"text-sm whitespace-pre-wrap"},ge={class:"text-sm"},xe={class:"flex gap-2 pt-4 border-t border-border"},pe=["disabled"];function ve(d,e,a,o,u,_){return l(),n("div",$,[t("div",ee,[t("div",te,[t("div",oe,[t("h3",se,"Ð”ÐµÑ‚Ð°Ð»Ð¸ Ð·Ð°ÑÐ²ÐºÐ¸ #"+i(a.consultation.id),1),t("button",{onClick:e[0]||(e[0]=s=>d.$emit("close")),class:"text-muted-foreground hover:text-foreground"}," âœ• ")])]),t("div",re,[a.consultation.user?(l(),n("div",le,[e[5]||(e[5]=t("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ",-1)),t("div",ne,[t("p",de,"ID: "+i(a.consultation.user.telegram_user_id),1),a.consultation.user.username?(l(),n("p",ae,"@"+i(a.consultation.user.username),1)):g("",!0),a.consultation.user.first_name?(l(),n("p",ie,i(a.consultation.user.first_name)+" "+i(a.consultation.user.last_name||""),1)):g("",!0)])])):g("",!0),t("div",null,[e[13]||(e[13]=t("h4",{class:"text-sm font-medium text-muted-foreground mb-2"},"Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð·Ð°ÑÐ²ÐºÐµ",-1)),t("div",ue,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"Ð˜Ð¼Ñ",-1)),t("p",me,i(a.consultation.name),1)]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½",-1)),t("p",be,i(a.consultation.phone),1)]),a.consultation.description?(l(),n("div",ce,[e[8]||(e[8]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",-1)),t("p",fe,i(a.consultation.description),1)])):g("",!0),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),m(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.status=s),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[9]||(e[9]=[t("option",{value:"new"},"ÐÐ¾Ð²Ð°Ñ",-1),t("option",{value:"in_progress"},"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",-1),t("option",{value:"closed"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð°",-1)])],512),[[E,o.form.status]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°",-1)),m(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.admin_notes=s),rows:"4",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ..."},null,512),[[x,o.form.admin_notes]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-xs text-muted-foreground mb-1"},"Ð”Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ",-1)),t("p",ge,i(o.formatDate(a.consultation.created_at)),1)])])]),t("div",xe,[t("button",{onClick:e[3]||(e[3]=s=>d.$emit("close")),class:"flex-1 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),t("button",{onClick:e[4]||(e[4]=(...s)=>o.saveConsultation&&o.saveConsultation(...s)),disabled:o.saving,class:"flex-1 h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"},i(o.saving?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"),9,pe)])])])])}const _e=S(Z,[["render",ve]]),ye={name:"ConsultationTable",components:{ConsultationDetail:_e},props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),a=f([]),o=f(null),u=f(1),_=f(20),s=f(0),r=f({status:"",date_from:"",date_to:""}),v=async()=>{e.value=!0;try{const b={page:u.value,per_page:_.value,...r.value},w=await B(`/bot-management/${d.botId}/consultations`,b);if(!w.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð·Ð°ÑÐ²Ð¾Ðº");const h=await w.json();a.value=h.data.consultations||[],s.value=h.data.total||0}catch(b){console.error("Error fetching consultations:",b)}finally{e.value=!1}},k=()=>{r.value={status:"",date_from:"",date_to:""},u.value=1,v()},y=b=>{o.value=b},U=b=>({new:"ÐÐ¾Ð²Ð°Ñ",in_progress:"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",closed:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð°"})[b]||b,p=b=>({new:"bg-blue-500/10 text-blue-500",in_progress:"bg-yellow-500/10 text-yellow-500",closed:"bg-green-500/10 text-green-500"})[b]||"bg-gray-500/10 text-gray-500",j=b=>new Date(b).toLocaleDateString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return A(u,()=>{v()}),T(()=>{v()}),{loading:e,consultations:a,selectedConsultation:o,currentPage:u,perPage:_,total:s,filters:r,fetchConsultations:v,resetFilters:k,showDetail:y,getStatusLabel:U,getStatusClass:p,formatDate:j}}},ke={class:"consultation-table space-y-4"},we={class:"bg-muted/30 rounded-lg border border-border p-4"},he={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Ce={class:"flex items-end"},Me={key:0,class:"text-center py-12"},Ue={key:1,class:"bg-background rounded-lg border border-border overflow-hidden"},Ie={class:"overflow-x-auto"},Ve={class:"w-full"},Be={class:"divide-y divide-border"},Se={class:"px-6 py-4 text-sm"},Te={class:"px-6 py-4 text-sm"},je={class:"px-6 py-4 text-sm"},qe={class:"px-6 py-4"},De={class:"px-6 py-4 text-sm"},Fe={class:"px-6 py-4 text-right"},Ee=["onClick"],Pe={key:0,class:"px-6 py-4 border-t border-border flex items-center justify-between"},ze={class:"text-sm text-muted-foreground"},Ae={class:"flex gap-2"},Ne=["disabled"],Le=["disabled"];function Re(d,e,a,o,u,_){const s=D("ConsultationDetail");return l(),n("div",ke,[e[16]||(e[16]=t("div",{class:"flex items-center justify-between"},[t("h2",{class:"text-2xl font-semibold"},"Ð—Ð°ÑÐ²ÐºÐ¸ Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ")],-1)),t("div",we,[t("div",he,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.filters.status=r),onChange:e[1]||(e[1]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[10]||(e[10]=[t("option",{value:""},"Ð’ÑÐµ",-1),t("option",{value:"new"},"ÐÐ¾Ð²Ñ‹Ðµ",-1),t("option",{value:"in_progress"},"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",-1),t("option",{value:"closed"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ",-1)])],544),[[E,o.filters.status]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium mb-2"},"Ð”Ð°Ñ‚Ð° Ð¾Ñ‚",-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.filters.date_from=r),type:"date",onChange:e[3]||(e[3]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),[[x,o.filters.date_from]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium mb-2"},"Ð”Ð°Ñ‚Ð° Ð´Ð¾",-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>o.filters.date_to=r),type:"date",onChange:e[5]||(e[5]=(...r)=>o.fetchConsultations&&o.fetchConsultations(...r)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),[[x,o.filters.date_to]])]),t("div",Ce,[t("button",{onClick:e[6]||(e[6]=(...r)=>o.resetFilters&&o.resetFilters(...r)),class:"w-full h-10 px-4 border border-border bg-background hover:bg-muted/10 rounded-lg"}," Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ ")])])]),o.loading?(l(),n("div",Me,[...e[14]||(e[14]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð·Ð°ÑÐ²Ð¾Ðº...",-1)])])):g("",!0),o.loading?g("",!0):(l(),n("div",Ue,[t("div",Ie,[t("table",Ve,[e[15]||(e[15]=t("thead",{class:"bg-muted/30 border-b border-border"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"ID"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"Ð˜Ð¼Ñ"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ"),t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase"},"Ð”Ð°Ñ‚Ð°"),t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase"},"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ")])],-1)),t("tbody",Be,[(l(!0),n(I,null,V(o.consultations,r=>(l(),n("tr",{key:r.id,class:"hover:bg-muted/10"},[t("td",Se,i(r.id),1),t("td",Te,i(r.name),1),t("td",je,i(r.phone),1),t("td",qe,[t("span",{class:P(["px-2 py-1 text-xs rounded-md",o.getStatusClass(r.status)])},i(o.getStatusLabel(r.status)),3)]),t("td",De,i(o.formatDate(r.created_at)),1),t("td",Fe,[t("button",{onClick:v=>o.showDetail(r),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded"}," Ð”ÐµÑ‚Ð°Ð»Ð¸ ",8,Ee)])]))),128))])])]),o.total>o.perPage?(l(),n("div",Pe,[t("div",ze," ÐŸÐ¾ÐºÐ°Ð·Ð°Ð½Ð¾ "+i((o.currentPage-1)*o.perPage+1)+" - "+i(Math.min(o.currentPage*o.perPage,o.total))+" Ð¸Ð· "+i(o.total),1),t("div",Ae,[t("button",{onClick:e[7]||(e[7]=r=>o.currentPage--),disabled:o.currentPage===1,class:"px-4 py-2 border border-border rounded-lg disabled:opacity-50"}," ÐÐ°Ð·Ð°Ð´ ",8,Ne),t("button",{onClick:e[8]||(e[8]=r=>o.currentPage++),disabled:o.currentPage*o.perPage>=o.total,class:"px-4 py-2 border border-border rounded-lg disabled:opacity-50"}," Ð’Ð¿ÐµÑ€ÐµÐ´ ",8,Le)])])):g("",!0)])),o.selectedConsultation?(l(),J(s,{key:2,consultation:o.selectedConsultation,"bot-id":a.botId,onClose:e[9]||(e[9]=r=>o.selectedConsultation=null),onUpdated:o.fetchConsultations},null,8,["consultation","bot-id","onUpdated"])):g("",!0)])}const Ge=S(ye,[["render",Re]]),Oe={name:"MaterialForm",props:{botId:{type:[String,Number],required:!0},categoryId:{type:[String,Number],default:null},material:{type:Object,default:null}},emits:["close","saved"],setup(d,{emit:e}){const a=f(!1),o=f(!1),u=f(!1),_=f(""),s=f([]),r=f(null),v=f(null),k=f(null),y=f(!!d.material),U=f([]),p=f({title:"",category_id:d.categoryId||null,description:"",file_type:"file",file_url:"",file_id:"",media_id:null,order_index:0,is_active:!0}),j=async()=>{try{const c=await B(`/bot-management/${d.botId}/materials/categories`);if(c.ok){const C=await c.json();U.value=C.data||[]}}catch(c){console.error("Error fetching categories:",c)}},b=async()=>{o.value=!0;try{const c={};_.value&&(c.search=_.value);const C=await B("/media",c);if(C.ok){const q=await C.json();s.value=q.data||[]}}catch(c){console.error("Error fetching media:",c)}finally{o.value=!1}},w=()=>{p.value.file_url="",p.value.file_id="",p.value.media_id=null,r.value=null,v.value=null},h=c=>{const C=c.target.files[0];C&&(r.value=C,p.value.media_id=null,v.value=null)},O=c=>{p.value.media_id=c.id,v.value=c,r.value=null},K=()=>{p.value.media_id&&(u.value=!1)},Q=c=>{if(!c)return"0 B";const C=1024,q=["B","KB","MB","GB"],N=Math.floor(Math.log(c)/Math.log(C));return Math.round(c/Math.pow(C,N)*100)/100+" "+q[N]},H=async()=>{a.value=!0;try{const c=new FormData;if(c.append("title",p.value.title),c.append("category_id",p.value.category_id),c.append("description",p.value.description||""),c.append("file_type",p.value.file_type),c.append("order_index",p.value.order_index||0),c.append("is_active",p.value.is_active?1:0),p.value.file_type==="file")if(r.value)c.append("file",r.value);else if(p.value.media_id)c.append("media_id",p.value.media_id);else throw new Error("ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð¸Ð»Ð¸ ÑƒÐºÐ°Ð·Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°-Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸");else p.value.file_type==="url"?c.append("file_url",p.value.file_url):p.value.file_type==="telegram_file_id"&&c.append("file_id",p.value.file_id);let C;if(y.value?C=await z(`/bot-management/${d.botId}/materials/${d.material.id}`,c):C=await Y(`/bot-management/${d.botId}/materials`,c),!C.ok){const q=await C.json().catch(()=>({}));throw new Error(q.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°")}await M.fire({title:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("saved"),e("close")}catch(c){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:c.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°",icon:"error",confirmButtonText:"ÐžÐš"})}finally{a.value=!1}};return d.material&&(p.value={title:d.material.title||"",category_id:d.material.category_id||d.categoryId||null,description:d.material.description||"",file_type:d.material.file_type||"file",file_url:d.material.file_url||"",file_id:d.material.file_id||"",media_id:d.material.media_id||null,order_index:d.material.order_index||0,is_active:d.material.is_active!==void 0?d.material.is_active:!0},d.material.media&&(v.value=d.material.media)),A(u,c=>{c&&b()}),A(_,()=>{u.value&&b()}),T(()=>{j()}),{saving:a,loadingMedia:o,showMediaPicker:u,mediaSearch:_,mediaFiles:s,selectedFile:r,selectedMedia:v,fileInput:k,isEditMode:y,categories:U,form:p,fetchMediaFiles:b,handleFileTypeChange:w,handleFileSelect:h,selectMedia:O,confirmMediaSelection:K,formatFileSize:Q,saveMaterial:H}}},Ke={class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},Qe={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},He={class:"sticky top-0 bg-background border-b border-border p-6"},Je={class:"flex items-center justify-between"},We={class:"text-lg font-semibold"},Xe=["value"],Ye={key:0},Ze={class:"space-y-3"},$e={key:0,class:"text-xs text-muted-foreground mt-1"},et={key:0,class:"text-xs text-muted-foreground mt-1"},tt={key:1},ot={key:2},st={class:"flex items-center gap-2"},rt={class:"flex gap-4 pt-4 border-t border-border"},lt=["disabled"],nt={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center bg-black/90 p-4"},dt={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col"},at={class:"p-6 border-b border-border"},it={class:"flex items-center justify-between"},ut={class:"flex-1 overflow-y-auto p-6"},mt={key:0,class:"text-center py-12"},bt={key:1,class:"text-center py-12 text-muted-foreground"},ct={key:2,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},ft=["onClick"],gt={class:"text-sm font-medium truncate"},xt={class:"text-xs text-muted-foreground mt-1"},pt={class:"p-6 border-t border-border"},vt=["disabled"];function _t(d,e,a,o,u,_){return l(),n("div",Ke,[t("div",Qe,[t("div",He,[t("div",Je,[t("h3",We,i(o.isEditMode?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»":"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»"),1),t("button",{onClick:e[0]||(e[0]=s=>d.$emit("close")),class:"text-muted-foreground hover:text-foreground"}," âœ• ")])]),t("form",{onSubmit:e[13]||(e[13]=R((...s)=>o.saveMaterial&&o.saveMaterial(...s),["prevent"])),class:"p-6 space-y-6"},[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium mb-2"},"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ *",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.title=s),type:"text",required:"",placeholder:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.title]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium mb-2"},"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ *",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.category_id=s),required:"",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[e[18]||(e[18]=t("option",{value:""},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ",-1)),(l(!0),n(I,null,V(o.categories,s=>(l(),n("option",{key:s.id,value:s.id},i(s.name),9,Xe))),128))],512),[[E,o.form.category_id,void 0,{number:!0}]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium mb-2"},"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",-1)),m(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.description=s),rows:"4",placeholder:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.description]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢Ð¸Ð¿ Ñ„Ð°Ð¹Ð»Ð° *",-1)),m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.file_type=s),required:"",onChange:e[5]||(e[5]=(...s)=>o.handleFileTypeChange&&o.handleFileTypeChange(...s)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},[...e[21]||(e[21]=[t("option",{value:"file"},"Ð¤Ð°Ð¹Ð» (Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð»Ð¸ Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°-Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸)",-1),t("option",{value:"url"},"Ð’Ð½ÐµÑˆÐ½ÑÑ ÑÑÑ‹Ð»ÐºÐ°",-1),t("option",{value:"telegram_file_id"},"Telegram file_id",-1)])],544),[[E,o.form.file_type]])]),o.form.file_type==="file"?(l(),n("div",Ye,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¤Ð°Ð¹Ð»",-1)),t("div",Ze,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-xs text-muted-foreground mb-2"}," Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» ",-1)),t("input",{ref:"fileInput",type:"file",onChange:e[6]||(e[6]=(...s)=>o.handleFileSelect&&o.handleFileSelect(...s)),class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,544),o.selectedFile?(l(),n("p",$e," Ð’Ñ‹Ð±Ñ€Ð°Ð½: "+i(o.selectedFile.name),1)):g("",!0)]),e[25]||(e[25]=t("div",{class:"text-center text-sm text-muted-foreground"},"Ð¸Ð»Ð¸",-1)),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-xs text-muted-foreground mb-2"}," Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°-Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ ",-1)),t("button",{type:"button",onClick:e[7]||(e[7]=s=>o.showMediaPicker=!0),class:"w-full h-10 px-4 border border-border rounded-lg bg-background hover:bg-muted/10"},i(o.form.media_id?"Ð¤Ð°Ð¹Ð» Ð²Ñ‹Ð±Ñ€Ð°Ð½":"Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»"),1),o.selectedMedia?(l(),n("p",et," Ð’Ñ‹Ð±Ñ€Ð°Ð½: "+i(o.selectedMedia.name),1)):g("",!0)])])])):g("",!0),o.form.file_type==="url"?(l(),n("div",tt,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-2"},"URL *",-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.file_url=s),type:"url",required:"",placeholder:"https://example.com/file.pdf",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.file_url]])])):g("",!0),o.form.file_type==="telegram_file_id"?(l(),n("div",ot,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium mb-2"},"Telegram file_id *",-1)),m(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.file_id=s),type:"text",required:"",placeholder:"BQACAgIAAxkBAAI...",class:"w-full h-10 px-3 border border-border rounded-lg bg-background font-mono text-sm"},null,512),[[x,o.form.file_id]]),e[29]||(e[29]=t("p",{class:"text-xs text-muted-foreground mt-1"}," ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ file_id Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ð² Ñ„Ð°Ð¹Ð» Ð±Ð¾Ñ‚Ñƒ Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ð² Ð¾Ñ‚Ð²ÐµÑ‚ API ",-1))])):g("",!0),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium mb-2"},"ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",-1)),m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.order_index=s),type:"number",min:"0",placeholder:"0",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.order_index,void 0,{number:!0}]])]),t("div",null,[t("label",st,[m(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.is_active=s),type:"checkbox",class:"w-4 h-4"},null,512),[[G,o.form.is_active]]),e[31]||(e[31]=t("span",null,"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½",-1))])]),t("div",rt,[t("button",{type:"button",onClick:e[12]||(e[12]=s=>d.$emit("close")),class:"flex-1 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," ÐžÑ‚Ð¼ÐµÐ½Ð° "),t("button",{type:"submit",disabled:o.saving,class:"flex-1 h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"},i(o.saving?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ"),9,lt)])],32),o.showMediaPicker?(l(),n("div",nt,[t("div",dt,[t("div",at,[t("div",it,[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold"},"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð¸Ð· Ð¼ÐµÐ´Ð¸Ð°-Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸",-1)),t("button",{onClick:e[14]||(e[14]=s=>o.showMediaPicker=!1),class:"text-muted-foreground hover:text-foreground"}," âœ• ")]),m(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>o.mediaSearch=s),type:"text",placeholder:"ÐŸÐ¾Ð¸ÑÐº Ñ„Ð°Ð¹Ð»Ð°...",class:"w-full mt-4 h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.mediaSearch]])]),t("div",ut,[o.loadingMedia?(l(),n("div",mt,[...e[33]||(e[33]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ„Ð°Ð¹Ð»Ð¾Ð²...",-1)])])):o.mediaFiles.length===0?(l(),n("div",bt," Ð¤Ð°Ð¹Ð»Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹ ")):(l(),n("div",ct,[(l(!0),n(I,null,V(o.mediaFiles,s=>(l(),n("div",{key:s.id,onClick:r=>o.selectMedia(s),class:P(["p-4 border rounded-lg cursor-pointer transition-colors",o.form.media_id===s.id?"border-accent bg-accent/10":"border-border hover:bg-muted/10"])},[t("div",gt,i(s.name),1),t("div",xt,i(o.formatFileSize(s.size)),1)],10,ft))),128))]))]),t("div",pt,[t("button",{onClick:e[16]||(e[16]=(...s)=>o.confirmMediaSelection&&o.confirmMediaSelection(...s)),disabled:!o.form.media_id,class:"w-full h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg disabled:opacity-50"}," Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ",8,vt)])])])):g("",!0)])])}const yt=S(Oe,[["render",_t]]),kt={name:"MaterialCategoryTree",components:{MaterialForm:yt},props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),a=f([]),o=f(!1),u=f(!1),_=f(null),s=f(null),r=async()=>{e.value=!0;try{const b=await B(`/bot-management/${d.botId}/materials/categories`);if(!b.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹");const w=await b.json();a.value=w.data||[];for(const h of a.value)await v(h)}catch(b){console.error("Error fetching categories:",b)}finally{e.value=!1}},v=async b=>{try{const w=await B(`/bot-management/${d.botId}/materials`,{category_id:b.id});if(w.ok){const h=await w.json();b.materials=h.data||[]}}catch(w){console.error("Error fetching materials:",w)}},k=async b=>{if((await M.fire({title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ?",text:`ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ "${b.name}" Ð¸ Ð²ÑÐµ ÐµÑ‘ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",cancelButtonText:"ÐžÑ‚Ð¼ÐµÐ½Ð°"})).isConfirmed)try{if(!(await L(`/bot-management/${d.botId}/materials/categories/${b.id}`)).ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸");await M.fire({title:"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(h){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:h.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",icon:"error"})}},y=async b=>{if((await M.fire({title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»?",text:`ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» "${b.title}" Ð±ÑƒÐ´ÐµÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ",cancelButtonText:"ÐžÑ‚Ð¼ÐµÐ½Ð°"})).isConfirmed)try{if(!(await L(`/bot-management/${d.botId}/materials/${b.id}`)).ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°");await M.fire({title:"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(h){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:h.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°",icon:"error"})}},U=async b=>{const{value:w}=await M.fire({title:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ",html:`
                    <input id="swal-name" class="swal2-input" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" value="${b.name}">
                    <textarea id="swal-description" class="swal2-textarea" placeholder="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ">${b.description||""}</textarea>
                    <input id="swal-order" class="swal2-input" type="number" placeholder="ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº" value="${b.order_index}">
                `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",cancelButtonText:"ÐžÑ‚Ð¼ÐµÐ½Ð°",preConfirm:()=>({name:document.getElementById("swal-name").value,description:document.getElementById("swal-description").value,order_index:parseInt(document.getElementById("swal-order").value)||0})});if(w)try{if(!(await z(`/bot-management/${d.botId}/materials/categories/${b.id}`,w)).ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸");await M.fire({title:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),r()}catch(h){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:h.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸",icon:"error"})}},p=b=>{s.value=b,u.value=!0},j=b=>{_.value=b,s.value=null,u.value=!0};return T(()=>{r()}),{loading:e,categories:a,showCategoryModal:o,showMaterialForm:u,selectedCategory:_,selectedMaterial:s,fetchCategories:r,createCategory,deleteCategory:k,deleteMaterial:y,editCategory:U,editMaterial:p,showMaterialModal:j}}},wt={class:"material-category-tree space-y-4"},ht={class:"flex items-center justify-between"},Ct={key:0,class:"text-center py-12"},Mt={key:1,class:"space-y-4"},Ut={class:"flex items-center justify-between mb-4"},It={class:"text-lg font-semibold"},Vt={key:0,class:"text-sm text-muted-foreground mt-1"},Bt={class:"flex gap-2"},St=["onClick"],Tt=["onClick"],jt=["onClick"],qt={key:0,class:"space-y-2"},Dt={class:"font-medium"},Ft={key:0,class:"text-sm text-muted-foreground"},Et={class:"text-xs text-muted-foreground"},Pt={class:"flex gap-2"},zt=["onClick"],At=["onClick"],Nt={key:1,class:"text-sm text-muted-foreground p-3"},Lt={key:0,class:"text-center py-12 text-muted-foreground"},Rt={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4"},Gt={class:"bg-background border border-border rounded-lg shadow-2xl w-full max-w-md"},Ot={class:"p-6"};function Kt(d,e,a,o,u,_){return l(),n("div",wt,[t("div",ht,[e[3]||(e[3]=t("h2",{class:"text-2xl font-semibold"},"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹",-1)),t("button",{onClick:e[0]||(e[0]=s=>o.showCategoryModal=!0),class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl"}," + Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ ")]),o.loading?(l(),n("div",Ct,[...e[4]||(e[4]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²...",-1)])])):g("",!0),o.loading?g("",!0):(l(),n("div",Mt,[(l(!0),n(I,null,V(o.categories,s=>(l(),n("div",{key:s.id,class:"bg-card rounded-lg border border-border p-4"},[t("div",Ut,[t("div",null,[t("h3",It,i(s.name),1),s.description?(l(),n("p",Vt,i(s.description),1)):g("",!0)]),t("div",Bt,[t("button",{onClick:r=>o.editCategory(s),class:"px-3 py-1 text-xs bg-yellow-500 hover:bg-yellow-600 text-white rounded"}," Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",8,St),t("button",{onClick:r=>o.deleteCategory(s),class:"px-3 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,Tt),t("button",{onClick:r=>o.showMaterialModal(s),class:"px-3 py-1 text-xs bg-green-500 hover:bg-green-600 text-white rounded"}," + ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» ",8,jt)])]),s.materials&&s.materials.length>0?(l(),n("div",qt,[(l(!0),n(I,null,V(s.materials,r=>(l(),n("div",{key:r.id,class:"flex items-center justify-between p-3 bg-muted/30 rounded-lg"},[t("div",null,[t("p",Dt,i(r.title),1),r.description?(l(),n("p",Ft,i(r.description),1)):g("",!0),t("p",Et," Ð¡ÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ð¹: "+i(r.download_count||0),1)]),t("div",Pt,[t("button",{onClick:v=>o.editMaterial(r),class:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded"}," Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ",8,zt),t("button",{onClick:v=>o.deleteMaterial(r),class:"px-3 py-1 text-xs bg-red-500 hover:bg-red-600 text-white rounded"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,At)])]))),128))])):(l(),n("div",Nt," ÐÐµÑ‚ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð² "))]))),128)),o.categories.length===0?(l(),n("div",Lt," ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð¿ÐµÑ€Ð²ÑƒÑŽ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ. ")):g("",!0)])),o.showCategoryModal?(l(),n("div",Rt,[t("div",Gt,[t("div",Ot,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold mb-4"},"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑŽ",-1)),t("button",{onClick:e[1]||(e[1]=(...s)=>o.createCategory&&o.createCategory(...s)),class:"w-full h-10 px-4 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-lg"}," ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ñ„Ð¾Ñ€Ð¼Ñƒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ "),t("button",{onClick:e[2]||(e[2]=s=>o.showCategoryModal=!1),class:"w-full mt-2 h-10 px-4 border border-border bg-background/50 hover:bg-accent/10 rounded-lg"}," ÐžÑ‚Ð¼ÐµÐ½Ð° ")])])])):g("",!0)])}const Qt=S(kt,[["render",Kt]]),Ht={name:"BotSettingsForm",props:{botId:{type:[String,Number],required:!0}},emits:["updated"],setup(d,{emit:e}){const a=f(!1),o=f(!1),u=f({required_channel_id:null,required_channel_username:"",admin_telegram_ids:[],yandex_maps_url:"",welcome_message:"",other_settings:{phone_validation_strict:!1,max_description_length:1e3,subscription_check_timeout:5}}),_=async()=>{a.value=!0;try{const k=await B(`/bot-management/${d.botId}/settings`);if(!k.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº");const y=await k.json();if(y.success&&y.data){const U=y.data.settings||{},p=U.messages||{};u.value={required_channel_id:y.data.required_channel_id||null,required_channel_username:y.data.required_channel_username||"",admin_telegram_ids:y.data.admin_telegram_ids||[],yandex_maps_url:y.data.yandex_maps_url||"",welcome_message:y.data.welcome_message||"",messages:{subscription:p.subscription||{required_text:"",subscribe_button:"",check_button:""},consultation:p.consultation||{description:"",form_name_label:"",form_phone_label:"",form_description_label:"",thank_you:"",start_button:"",skip_description_button:""},materials:p.materials||{list_description:"",download_button:"",back_to_list:""},menu:p.menu||{materials_button:"",consultation_button:"",review_button:"",back_to_menu:""},notifications:p.notifications||{consultation_template:""}},other_settings:U.other_settings||{phone_validation_strict:!1,max_description_length:1e3,subscription_check_timeout:5}}}}catch(k){console.error("Error fetching settings:",k)}finally{a.value=!1}},s=async()=>{o.value=!0;try{const k=await z(`/bot-management/${d.botId}/settings`,{required_channel_id:u.value.required_channel_id,required_channel_username:u.value.required_channel_username,admin_telegram_ids:u.value.admin_telegram_ids,yandex_maps_url:u.value.yandex_maps_url,welcome_message:u.value.welcome_message,settings:{messages:u.value.messages,other_settings:u.value.other_settings}});if(!k.ok){const y=await k.json().catch(()=>({}));throw new Error(y.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº")}await M.fire({title:"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"}),e("updated")}catch(k){M.fire({title:"ÐžÑˆÐ¸Ð±ÐºÐ°",text:k.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº",icon:"error",confirmButtonText:"ÐžÐš"})}finally{o.value=!1}},r=()=>{u.value.admin_telegram_ids.push(null)},v=k=>{u.value.admin_telegram_ids.splice(k,1)};return T(()=>{_()}),{loading:a,saving:o,activeTab,tabs,form:u,fetchSettings:_,saveSettings:s,addAdmin:r,removeAdmin:v}}},Jt={class:"bot-settings-form space-y-6"},Wt={class:"border-b border-border"},Xt={class:"flex -mb-px"},Yt=["onClick"],Zt={key:0,class:"bg-card rounded-lg border border-border p-6 space-y-4"},$t={class:"space-y-2"},eo=["onUpdate:modelValue"],to=["onClick"],oo={key:1,class:"bg-card rounded-lg border border-border p-6 space-y-6"},so={class:"space-y-4"},ro={class:"space-y-4 pt-4 border-t border-border"},lo={class:"space-y-4 pt-4 border-t border-border"},no={class:"space-y-4 pt-4 border-t border-border"},ao={class:"space-y-4 pt-4 border-t border-border"},io={key:2,class:"bg-card rounded-lg border border-border p-6 space-y-4"},uo={class:"flex items-center gap-2"},mo={class:"flex gap-4"},bo=["disabled"];function co(d,e,a,o,u,_){return l(),n("div",Jt,[e[64]||(e[64]=t("h2",{class:"text-2xl font-semibold"},"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð±Ð¾Ñ‚Ð°",-1)),t("div",Wt,[t("nav",Xt,[(l(!0),n(I,null,V(o.tabs,s=>(l(),n("button",{key:s.key,onClick:r=>o.activeTab=s.key,class:P(["px-6 py-4 text-sm font-medium border-b-2 transition-colors",o.activeTab===s.key?"border-accent text-accent":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},i(s.label),11,Yt))),128))])]),t("form",{onSubmit:e[26]||(e[26]=R((...s)=>o.saveSettings&&o.saveSettings(...s),["prevent"])),class:"space-y-6"},[o.activeTab==="main"?(l(),n("div",Zt,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold"},"ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",-1)),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium mb-2"},"ID ÐºÐ°Ð½Ð°Ð»Ð°",-1)),m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.required_channel_id=s),type:"number",placeholder:"-1001234567890",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.required_channel_id,void 0,{number:!0}]]),e[28]||(e[28]=t("p",{class:"text-xs text-muted-foreground mt-1"}," ID ÐºÐ°Ð½Ð°Ð»Ð° (Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ñ‚Ð° @userinfobot) ",-1))]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium mb-2"},"Username ÐºÐ°Ð½Ð°Ð»Ð°",-1)),m(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.required_channel_username=s),type:"text",placeholder:"aip_channel",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.required_channel_username]]),e[30]||(e[30]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Username ÐºÐ°Ð½Ð°Ð»Ð° Ð±ÐµÐ· ÑÐ¸Ð¼Ð²Ð¾Ð»Ð° @ ",-1))]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium mb-2"},"Telegram ID Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð²",-1)),t("div",$t,[(l(!0),n(I,null,V(o.form.admin_telegram_ids,(s,r)=>(l(),n("div",{key:r,class:"flex gap-2"},[m(t("input",{"onUpdate:modelValue":v=>o.form.admin_telegram_ids[r]=v,type:"number",placeholder:"123456789",class:"flex-1 h-10 px-3 border border-border rounded-lg bg-background"},null,8,eo),[[x,o.form.admin_telegram_ids[r],void 0,{number:!0}]]),t("button",{type:"button",onClick:v=>o.removeAdmin(r),class:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg"}," Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ",8,to)]))),128)),t("button",{type:"button",onClick:e[2]||(e[2]=(...s)=>o.addAdmin&&o.addAdmin(...s)),class:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg"}," + Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° ")])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ ÐšÐ°Ñ€Ñ‚Ñ‹",-1)),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.yandex_maps_url=s),type:"url",placeholder:"https://yandex.ru/maps/org/...",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.yandex_maps_url]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium mb-2"},"ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ",-1)),m(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.welcome_message=s),rows:"6",placeholder:"Ð”Ð¾Ð±Ñ€Ð¾ Ð¿Ð¾Ð¶Ð°Ð»Ð¾Ð²Ð°Ñ‚ÑŒ...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.welcome_message]])])])):g("",!0),o.activeTab==="messages"?(l(),n("div",oo,[e[59]||(e[59]=t("h3",{class:"text-lg font-semibold"},"Ð¢ÐµÐºÑÑ‚Ñ‹ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹ Ð±Ð¾Ñ‚Ð°",-1)),t("div",so,[e[38]||(e[38]=t("h4",{class:"text-md font-medium"},"ÐŸÐ¾Ð´Ð¿Ð¸ÑÐºÐ° Ð½Ð° ÐºÐ°Ð½Ð°Ð»",-1)),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢ÐµÐºÑÑ‚ ÑÐºÑ€Ð°Ð½Ð° Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸",-1)),m(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.form.messages.subscription.required_text=s),rows:"3",placeholder:"Ð”Ð»Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð±ÐµÑ‚Ð°-Ð²ÐµÑ€ÑÐ¸Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.subscription.required_text]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸",-1)),m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.messages.subscription.subscribe_button=s),type:"text",placeholder:"ðŸ”” ÐŸÐ¾Ð´Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° Telegram",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.subscription.subscribe_button]])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸",-1)),m(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.form.messages.subscription.check_button=s),type:"text",placeholder:"âœ… Ð¯ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ð»ÑÑ",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.subscription.check_button]])])]),t("div",ro,[e[46]||(e[46]=t("h4",{class:"text-md font-medium"},"ÐšÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ",-1)),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium mb-2"},"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸",-1)),m(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.messages.consultation.description=s),rows:"4",placeholder:"Ð•ÑÐ»Ð¸ Ð²Ð°ÑˆÐµÐ¼Ñƒ Ð±Ð¸Ð·Ð½ÐµÑÑƒ Ð½ÑƒÐ¶Ð½Ð° Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð°Ñ...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.consultation.description]])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ Ð¿Ð¾Ð»Ñ "Ð˜Ð¼Ñ"',-1)),m(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>o.form.messages.consultation.form_name_label=s),type:"text",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÐµ Ð¸Ð¼Ñ:",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_name_label]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ Ð¿Ð¾Ð»Ñ "Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½"',-1)),m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.messages.consultation.form_phone_label=s),type:"text",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ð°Ñˆ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½:",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_phone_label]])]),t("div",null,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ Ð¿Ð¾Ð»Ñ "ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ"',-1)),m(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.messages.consultation.form_description_label=s),type:"text",placeholder:"ÐšÑ€Ð°Ñ‚ÐºÐ¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾...):",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.form_description_label]])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸",-1)),m(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>o.form.messages.consultation.thank_you=s),rows:"2",placeholder:"Ð¡Ð¿Ð°ÑÐ¸Ð±Ð¾. ÐœÑ‹ ÑÐ²ÑÐ¶ÐµÐ¼ÑÑ Ñ Ð²Ð°Ð¼Ð¸ Ð² Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐµ Ð²Ñ€ÐµÐ¼Ñ.",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.consultation.thank_you]])]),t("div",null,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ"',-1)),m(t("input",{"onUpdate:modelValue":e[13]||(e[13]=s=>o.form.messages.consultation.start_button=s),type:"text",placeholder:"ðŸ“ Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.start_button]])]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐŸÑ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ"',-1)),m(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>o.form.messages.consultation.skip_description_button=s),type:"text",placeholder:"ÐŸÑ€Ð¾Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.consultation.skip_description_button]])])]),t("div",lo,[e[50]||(e[50]=t("h4",{class:"text-md font-medium"},"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹",-1)),t("div",null,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium mb-2"},"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑÐ¿Ð¸ÑÐºÐ° Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²",-1)),m(t("textarea",{"onUpdate:modelValue":e[15]||(e[15]=s=>o.form.messages.materials.list_description=s),rows:"3",placeholder:"ÐœÑ‹ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð¸Ð»Ð¸ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð¿Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ð¼ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑÐ¼...",class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none"},null,512),[[x,o.form.messages.materials.list_description]])]),t("div",null,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ñ",-1)),m(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>o.form.messages.materials.download_button=s),type:"text",placeholder:"â¬‡ï¸ Ð¡ÐºÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.materials.download_button]])]),t("div",null,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐÐ°Ð·Ð°Ð´"',-1)),m(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>o.form.messages.materials.back_to_list=s),type:"text",placeholder:"â¬…ï¸ ÐÐ°Ð·Ð°Ð´",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.materials.back_to_list]])])]),t("div",no,[e[55]||(e[55]=t("h4",{class:"text-md font-medium"},"Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ",-1)),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹"',-1)),m(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>o.form.messages.menu.materials_button=s),type:"text",placeholder:"ðŸ“‚ ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð¸ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñ‹",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.materials_button]])]),t("div",null,[e[52]||(e[52]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐšÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ"',-1)),m(t("input",{"onUpdate:modelValue":e[19]||(e[19]=s=>o.form.messages.menu.consultation_button=s),type:"text",placeholder:"ðŸ“ž Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒÑÑ Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.consultation_button]])]),t("div",null,[e[53]||(e[53]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐžÑ‚Ð·Ñ‹Ð²"',-1)),m(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>o.form.messages.menu.review_button=s),type:"text",placeholder:"â­ ÐžÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð·Ñ‹Ð² Ð½Ð° Ð¯Ð½Ð´ÐµÐºÑ ÐšÐ°Ñ€Ñ‚Ð°Ñ…",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.review_button]])]),t("div",null,[e[54]||(e[54]=t("label",{class:"block text-sm font-medium mb-2"},'Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "ÐÐ°Ð·Ð°Ð´ Ð² Ð¼ÐµÐ½ÑŽ"',-1)),m(t("input",{"onUpdate:modelValue":e[21]||(e[21]=s=>o.form.messages.menu.back_to_menu=s),type:"text",placeholder:"â¬…ï¸ ÐÐ°Ð·Ð°Ð´ Ð² Ð¼ÐµÐ½ÑŽ",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.messages.menu.back_to_menu]])])]),t("div",ao,[e[58]||(e[58]=t("h4",{class:"text-md font-medium"},"Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°Ð¼",-1)),t("div",null,[e[56]||(e[56]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¨Ð°Ð±Ð»Ð¾Ð½ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð½Ð¾Ð²Ð¾Ð¹ Ð·Ð°ÑÐ²ÐºÐµ",-1)),m(t("textarea",{"onUpdate:modelValue":e[22]||(e[22]=s=>o.form.messages.notifications.consultation_template=s),rows:"6",placeholder:`ÐÐ¾Ð²Ð°Ñ Ð·Ð°ÑÐ²ÐºÐ° Ð½Ð° ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸ÑŽ

Ð˜Ð¼Ñ: {name}
Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½: {phone}
ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ: {description}
Ð”Ð°Ñ‚Ð°: {date}`,class:"w-full px-3 py-2 border border-border rounded-lg bg-background resize-none font-mono text-sm"},null,512),[[x,o.form.messages.notifications.consultation_template]]),e[57]||(e[57]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ: {name}, {phone}, {description}, {date} ",-1))])])])):g("",!0),o.activeTab==="advanced"?(l(),n("div",io,[e[63]||(e[63]=t("h3",{class:"text-lg font-semibold"},"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸",-1)),t("div",null,[t("label",uo,[m(t("input",{"onUpdate:modelValue":e[23]||(e[23]=s=>o.form.other_settings.phone_validation_strict=s),type:"checkbox",class:"w-4 h-4"},null,512),[[G,o.form.other_settings.phone_validation_strict]]),e[60]||(e[60]=t("span",null,"Ð¡Ñ‚Ñ€Ð¾Ð³Ð°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð°",-1))])]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium mb-2"},"ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð»Ð¸Ð½Ð° Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ",-1)),m(t("input",{"onUpdate:modelValue":e[24]||(e[24]=s=>o.form.other_settings.max_description_length=s),type:"number",min:"10",max:"5000",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.other_settings.max_description_length,void 0,{number:!0}]])]),t("div",null,[e[62]||(e[62]=t("label",{class:"block text-sm font-medium mb-2"},"Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸ (ÑÐµÐº)",-1)),m(t("input",{"onUpdate:modelValue":e[25]||(e[25]=s=>o.form.other_settings.subscription_check_timeout=s),type:"number",min:"1",max:"30",class:"w-full h-10 px-3 border border-border rounded-lg bg-background"},null,512),[[x,o.form.other_settings.subscription_check_timeout,void 0,{number:!0}]])])])):g("",!0),t("div",mo,[t("button",{type:"submit",disabled:o.saving,class:"flex-1 h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl disabled:opacity-50"},i(o.saving?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ...":"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"),9,bo)])],32)])}const fo=S(Ht,[["render",co]]),go={name:"BotStatistics",props:{botId:{type:[String,Number],required:!0}},setup(d){const e=f(!1),a=f(null),o=async()=>{e.value=!0;try{const u=await B(`/bot-management/${d.botId}/statistics`);if(!u.ok)throw new Error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸");const _=await u.json();_.success&&_.data&&(a.value=_.data)}catch(u){console.error("Error fetching statistics:",u)}finally{e.value=!1}};return T(()=>{o()}),{loading:e,statistics:a}}},xo={class:"bot-statistics space-y-6"},po={key:0,class:"text-center py-12"},vo={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},_o={class:"bg-card rounded-lg border border-border p-6"},yo={class:"text-3xl font-semibold"},ko={class:"bg-card rounded-lg border border-border p-6"},wo={class:"text-3xl font-semibold"},ho={class:"bg-card rounded-lg border border-border p-6"},Co={class:"text-3xl font-semibold"},Mo={class:"bg-card rounded-lg border border-border p-6"},Uo={class:"text-3xl font-semibold"},Io={key:2,class:"bg-card rounded-lg border border-border p-6"},Vo={class:"grid grid-cols-3 gap-4"},Bo={class:"text-2xl font-semibold"},So={class:"text-2xl font-semibold"},To={class:"text-2xl font-semibold"},jo={key:3,class:"bg-card rounded-lg border border-border p-6"},qo={class:"space-y-2"},Do={class:"font-medium"},Fo={class:"text-sm text-muted-foreground"};function Eo(d,e,a,o,u,_){return l(),n("div",xo,[e[10]||(e[10]=t("h2",{class:"text-2xl font-semibold"},"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°",-1)),o.loading?(l(),n("div",po,[...e[0]||(e[0]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ¸...",-1)])])):g("",!0),!o.loading&&o.statistics?(l(),n("div",vo,[t("div",_o,[e[1]||(e[1]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"Ð’ÑÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹",-1)),t("p",yo,i(o.statistics.total_users||0),1)]),t("div",ko,[e[2]||(e[2]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ð·Ð° 30 Ð´Ð½ÐµÐ¹",-1)),t("p",wo,i(o.statistics.active_users_30d||0),1)]),t("div",ho,[e[3]||(e[3]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"Ð’ÑÐµÐ³Ð¾ Ð·Ð°ÑÐ²Ð¾Ðº",-1)),t("p",Co,i(o.statistics.total_consultations||0),1)]),t("div",Mo,[e[4]||(e[4]=t("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"Ð¡ÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ð¹ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²",-1)),t("p",Uo,i(o.statistics.materials_downloads||0),1)])])):g("",!0),!o.loading&&o.statistics?(l(),n("div",Io,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold mb-4"},"Ð—Ð°ÑÐ²ÐºÐ¸ Ð¿Ð¾ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°Ð¼",-1)),t("div",Vo,[t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-muted-foreground"},"ÐÐ¾Ð²Ñ‹Ðµ",-1)),t("p",Bo,i(o.statistics.consultations_by_status?.new||0),1)]),t("div",null,[e[6]||(e[6]=t("p",{class:"text-sm text-muted-foreground"},"Ð’ Ñ€Ð°Ð±Ð¾Ñ‚Ðµ",-1)),t("p",So,i(o.statistics.consultations_by_status?.in_progress||0),1)]),t("div",null,[e[7]||(e[7]=t("p",{class:"text-sm text-muted-foreground"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ",-1)),t("p",To,i(o.statistics.consultations_by_status?.closed||0),1)])])])):g("",!0),!o.loading&&o.statistics&&o.statistics.popular_materials?.length>0?(l(),n("div",jo,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold mb-4"},"ÐŸÐ¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹",-1)),t("div",qo,[(l(!0),n(I,null,V(o.statistics.popular_materials,s=>(l(),n("div",{key:s.id,class:"flex items-center justify-between p-3 bg-muted/30 rounded-lg"},[t("p",Do,i(s.title),1),t("p",Fo,i(s.download_count||0)+" ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ð¹",1)]))),128))])])):g("",!0)])}const Po=S(go,[["render",Eo]]),zo={name:"BotManagement",components:{ConsultationTable:Ge,MaterialCategoryTree:Qt,BotSettingsForm:fo,BotStatistics:Po},setup(){const d=X(),e=W(()=>d.params.botId),a=f(!1),o=f(null),u=f(null),_=f("consultations"),s=[{key:"consultations",label:"Ð—Ð°ÑÐ²ÐºÐ¸"},{key:"materials",label:"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹"},{key:"settings",label:"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"},{key:"statistics",label:"Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°"}],r=async()=>{a.value=!0,o.value=null;try{const v=await B(`/bots/${e.value}`);if(!v.ok){const y=await v.json().catch(()=>({}));throw new Error(y.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð±Ð¾Ñ‚Ð°")}const k=await v.json();u.value=k.data||null}catch(v){o.value=v.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð±Ð¾Ñ‚Ð°"}finally{a.value=!1}};return T(()=>{r()}),{botId:e,loading:a,error:o,bot:u,activeTab:_,tabs:s,fetchBot:r}}},Ao={class:"bot-management-page space-y-6"},No={class:"flex items-center justify-between"},Lo={key:0,class:"text-muted-foreground mt-1"},Ro={key:0,class:"flex items-center justify-center py-12"},Go={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},Oo={class:"text-destructive"},Ko={key:2,class:"bg-card rounded-lg border border-border"},Qo={class:"border-b border-border"},Ho={class:"flex -mb-px"},Jo=["onClick"],Wo={class:"p-6"},Xo={key:0},Yo={key:1},Zo={key:2},$o={key:3};function es(d,e,a,o,u,_){const s=D("ConsultationTable"),r=D("MaterialCategoryTree"),v=D("BotSettingsForm"),k=D("BotStatistics");return l(),n("div",Ao,[t("div",No,[t("div",null,[e[1]||(e[1]=t("h1",{class:"text-3xl font-semibold text-foreground"},"Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ñ‚Ð¾Ð¼",-1)),o.bot?(l(),n("p",Lo,i(o.bot.name),1)):g("",!0)]),t("button",{onClick:e[0]||(e[0]=y=>d.$router.push({name:"admin.bots"})),class:"h-11 px-6 bg-accent/10 backdrop-blur-xl text-accent border border-accent/40 hover:bg-accent/20 rounded-2xl shadow-lg shadow-accent/10 inline-flex items-center justify-center gap-2"}," â† ÐÐ°Ð·Ð°Ð´ Ðº Ð±Ð¾Ñ‚Ð°Ð¼ ")]),o.loading?(l(),n("div",Ro,[...e[2]||(e[2]=[t("p",{class:"text-muted-foreground"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…...",-1)])])):g("",!0),o.error?(l(),n("div",Go,[t("p",Oo,i(o.error),1)])):g("",!0),!o.loading&&o.bot?(l(),n("div",Ko,[t("div",Qo,[t("nav",Ho,[(l(!0),n(I,null,V(o.tabs,y=>(l(),n("button",{key:y.key,onClick:U=>o.activeTab=y.key,class:P(["px-6 py-4 text-sm font-medium border-b-2 transition-colors",o.activeTab===y.key?"border-accent text-accent":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted-foreground"])},i(y.label),11,Jo))),128))])]),t("div",Wo,[o.activeTab==="consultations"?(l(),n("div",Xo,[F(s,{"bot-id":o.botId},null,8,["bot-id"])])):g("",!0),o.activeTab==="materials"?(l(),n("div",Yo,[F(r,{"bot-id":o.botId},null,8,["bot-id"])])):g("",!0),o.activeTab==="settings"?(l(),n("div",Zo,[F(v,{"bot-id":o.botId,onUpdated:o.fetchBot},null,8,["bot-id","onUpdated"])])):g("",!0),o.activeTab==="statistics"?(l(),n("div",$o,[F(k,{"bot-id":o.botId},null,8,["bot-id"])])):g("",!0)])])):g("",!0)])}const rs=S(zo,[["render",es]]);export{rs as default};
