# –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é –ø–∞—Ä—Å–µ—Ä–∞ TrendAgent

–ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –í—Å—è –ª–æ–≥–∏–∫–∞ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ, —Å–ª–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω Strategy

```php
// –î–æ (—Ç–µ–∫—É—â–∏–π –∫–æ–¥)
if ($objectType === 'parking') {
    $apiData = $apiAuth->getParkingsSearch($apiParams);
} elseif ($objectType === 'plots') {
    // ...
}

// –ü–æ—Å–ª–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ–¥—Ö–æ–¥)
$parser = new TrendParserService($auth);
$parser->setStrategy('apartments'); // –∏–ª–∏ 'parking', 'plots', 'commercial'
$results = $parser->search($params);
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫

```
app/Services/TrendParser/
‚îú‚îÄ‚îÄ Strategies/          # –ö–ª–∞—Å—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤
‚îú‚îÄ‚îÄ Transformers/        # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
‚îú‚îÄ‚îÄ Builders/           # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL, –∑–∞–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ Exceptions/         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ TrendParserService.php  # –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å
```

### 3. –ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ —Ç–∏–ø—ã –æ–±—ä–µ–∫—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –µ–¥–∏–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:

```php
[
    'id' => string,
    'type' => 'apartment' | 'parking' | 'house' | 'commercial',
    'name' => string,
    'address' => string,
    'location' => [...],
    'builder' => [...],
    'prices' => [...],
    'images' => [
        'url_thumbnail' => string,
        'url_full' => string,
    ],
    'metadata' => [...],
]
```

### 4. –†–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

**–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ImageUrlBuilder:**

```php
$builder = new ImageUrlBuilder();
$thumbnailUrl = $builder->buildThumbnailUrl($imageData);
$fullUrl = $builder->buildFullUrl($imageData);
```

**–§–æ—Ä–º–∞—Ç URL:**
- –ú–∏–Ω–∏–∞—Ç—é—Ä–∞: `https://selcdn.trendagent.ru/images/{path}/m_{file_name}`
- –ü–æ–ª–Ω–æ–µ: `https://selcdn.trendagent.ru/images/{path}/{file_name}`

### 5. –ü–∞–≥–∏–Ω–∞—Ü–∏—è

**–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö:**

```php
foreach ($parser->getAllResults($params) as $pageResults) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    foreach ($pageResults['data'] as $item) {
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    }
}
```

### 6. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å:**
- –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (TTL: 5 –º–∏–Ω—É—Ç)
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (TTL: 1 —á–∞—Å)

**–ù–µ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å:**
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ (–¥–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–æ –º–µ–Ω—è—é—Ç—Å—è)

### 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:**

```php
try {
    $results = $parser->search($params);
} catch (AuthenticationException $e) {
    // –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
} catch (RateLimitException $e) {
    // –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
} catch (ParserException $e) {
    // –î—Ä—É–≥–∞—è –æ—à–∏–±–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

1. **TREND_API_ANALYSIS.md** - –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö API endpoints
2. **TREND_API_DATA_STRUCTURES.md** - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
3. **TREND_PARSER_RECOMMENDATIONS.md** - –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞

## üîß –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö endpoints
php artisan trend:test-endpoints

# –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
php artisan trend:analyze-structures
```

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ú–∏–Ω–∏–º—É–º –¥–ª—è MVP:
- [ ] –°–æ–∑–¥–∞—Ç—å Strategy –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–æ–≤
- [ ] –°–æ–∑–¥–∞—Ç—å Transformers –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ImageUrlBuilder –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### –î–ª—è production:
- [ ] –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] Retry –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –æ—à–∏–±–æ–∫
- [ ] Rate limiting
- [ ] Unit –∏ Feature —Ç–µ—Å—Ç—ã

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:** –ñ–∏–≤—É—Ç ~5 –º–∏–Ω—É—Ç, –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å
2. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:** –í GeoJSON —Ñ–æ—Ä–º–∞—Ç–µ `[longitude, latitude]` (–Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç!)
3. **–î–∞—Ç—ã:** –í—Å–µ–≥–¥–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601
4. **Rate limiting:** API –º–æ–∂–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
5. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `types=banks&types=subways`)

---

**–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π —Å–º–æ—Ç—Ä–∏—Ç–µ TREND_PARSER_RECOMMENDATIONS.md**

