# Результаты тестирования парсера

**Дата:** 29 декабря 2025

## Статус парсера

### ✅ Успешно работает:
- **Блоки (Квартиры)**: 40 объектов успешно обработано (0 создано, 40 обновлено), ошибок нет

### ⚠️ Ошибки "Array to string conversion":
- **Паркинги**: 100 объектов получено, но 2 ошибки при сохранении
- **Поселки (Дома с участками)**: 53 объекта получено, но 2 ошибки при сохранении (поле `distance`)
- **Коммерческие помещения**: 100 объектов получено, но 2 ошибки при сохранении (поле `property_types`)

### ℹ️ Информация:
- **Участки**: 0 объектов (эндпоинт возвращает фильтры, а не объекты)
- **Коммерческие объекты**: 0 объектов (неправильная структура ответа)

## Время выполнения
- С лимитом 100: ~25 секунд
- Без лимита (1000 по умолчанию): ~1.5 минуты

## Проблема

Ошибки возникают для JSON полей (`distance`, `property_types`, `metadata`, `advantages`, `payment_types`, `contract_types`). 

В SQL запросах видно, что эти поля передаются как JSON строки, хотя они должны быть массивами для полей с cast 'array' в Laravel моделях.

**Причина**: Возможно, данные из API приходят уже в сериализованном виде, или есть проблема с преобразованием объектов в массивы.

## Следующие шаги

1. Обновить код на сервере (исправления уже отправлены в git)
2. Выполнить миграцию для изменения уникального индекса `locations`
3. Добавить дополнительное логирование для диагностики формата данных из API
4. Проверить, не приходят ли данные из API уже в виде JSON строк

