# Инструкция для ручного обновления сервера

Проблема: сервер использует старую версию кода, где нет логики использования `expectedCommitHash` для деплоя. Чтобы новый код попал на сервер, нужно обновить его вручную один раз.

## Шаг 1: Подключиться к серверу по SSH

```bash
ssh dsc23ytp@dragon
```

## Шаг 2: Перейти в директорию проекта

```bash
cd /home/d/dsc23ytp/trendagent.siteaccess.ru/public_html
```

## Шаг 3: Обновить код до последнего коммита

```bash
# Проверить текущий коммит
git log --oneline -1

# Получить последние изменения
git fetch origin

# Обновить до последнего коммита (замените <LATEST_COMMIT> на актуальный коммит)
git reset --hard <LATEST_COMMIT>
# Например: git reset --hard 0e982cb3
```

## Шаг 4: Очистить кеш Laravel

```bash
php artisan config:clear
php artisan cache:clear
php artisan route:clear
php artisan view:clear
php artisan optimize:clear
```

## Шаг 5: Проверить, что код обновлен

```bash
# Проверить коммит
git log --oneline -1

# Должен показать последний коммит, например:
# 0e982cb3 Fix: улучшен git fetch - добавлена проверка через ls-remote и принудительное обновление remote refs
```

После этого автоматический деплой будет работать правильно, так как новый код использует `expectedCommitHash` для правильного обновления.

## Альтернативный способ (если есть доступ через веб-интерфейс)

Можно также выполнить эти команды через SSH доступ в панели управления хостингом (Beget).
